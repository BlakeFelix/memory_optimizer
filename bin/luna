#!/usr/bin/env python3
"""Entry point for the LUNA query wrapper."""
import os
import sys
from pathlib import Path


def _run() -> int:
    args = sys.argv[1:]
    debug = False
    if "--debug" in args:
        args.remove("--debug")
        debug = True

    home = Path.home() / "memory_optimizer"
    if home.exists() and not Path.cwd().resolve().samefile(home):
        os.chdir(home)

    if debug:
        os.environ["LUNA_DEBUG"] = "1"
        print(f"cwd: {os.getcwd()}", file=sys.stderr)

    sys.argv = [sys.argv[0]] + args
    from ai_memory.luna_wrapper import main

    return main()


if __name__ == "__main__":
    sys.exit(_run())
